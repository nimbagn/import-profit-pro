{% extends "base_modern_complete.html" %}
{% block title %}Nouvelle Assignation - {{ vehicle.plate_number }} - Import Profit Pro{% endblock %}

{% block extra_css %}
<style>
  .main-content {
    width: 100% !important;
    max-width: 100% !important;
    padding: 0 !important;
    margin-left: 280px !important;
    margin-top: 70px !important;
  }
  
  .page-container {
    width: 100%;
    min-height: calc(100vh - 70px);
    padding: var(--space-xl);
    background: var(--bg-secondary);
  }
  
  .form-container {
    max-width: 800px;
    margin: 0 auto;
  }
</style>
{% endblock %}

{% block content %}
<div class="page-container">
  <div class="page-header-hl">
    <h1 class="page-title-hl">
      <i class="fas fa-user-plus me-2"></i>
      Nouvelle Assignation - {{ vehicle.plate_number }}
    </h1>
    <a href="{{ url_for('flotte.vehicle_assignments', vehicle_id=vehicle.id) }}" class="btn-hl btn-hl-outline">
      <i class="fas fa-arrow-left me-2"></i>Retour
    </a>
  </div>

  <div class="form-container">
    <div class="card-hl">
      <div class="card-body-hl">
        <form method="POST">
          <div style="margin-bottom: var(--space-lg);">
            <label for="user_id" class="form-label-hl">
              <i class="fas fa-user me-2"></i>Conducteur <span style="color: var(--color-danger);">*</span>
            </label>
            <select name="user_id" id="user_id" class="form-control-hl" required>
              <option value="">Sélectionner un conducteur</option>
              {% for user in users %}
              <option value="{{ user.id }}" {% if vehicle.current_user_id == user.id %}selected{% endif %}>
                {{ user.full_name or user.username }} {% if user.email %}({{ user.email }}){% endif %}
              </option>
              {% endfor %}
            </select>
          </div>

          <div style="margin-bottom: var(--space-lg);">
            <label for="start_date" class="form-label-hl">
              <i class="fas fa-calendar me-2"></i>Date de Début <span style="color: var(--color-danger);">*</span>
            </label>
            <input type="date" name="start_date" id="start_date" class="form-control-hl" 
                   value="{{ today.strftime('%Y-%m-%d') }}" required>
          </div>

          <div style="margin-bottom: var(--space-lg);">
            <label for="reason" class="form-label-hl">
              <i class="fas fa-comment me-2"></i>Raison de l'Assignation
            </label>
            <input type="text" name="reason" id="reason" class="form-control-hl" 
                   placeholder="Ex: Nouvelle assignation, Remplacement, etc.">
            <small style="color: var(--text-secondary); font-size: 0.875rem;">
              Si une assignation est déjà active, elle sera automatiquement terminée.
            </small>
          </div>

          <div style="margin-bottom: var(--space-lg);">
            <label for="notes" class="form-label-hl">
              <i class="fas fa-sticky-note me-2"></i>Notes
            </label>
            <textarea name="notes" id="notes" class="form-control-hl" rows="4" 
                      placeholder="Notes supplémentaires sur cette assignation..."></textarea>
          </div>

          <div style="display: flex; gap: var(--space-md); justify-content: flex-end; margin-top: var(--space-xl);">
            <a href="{{ url_for('flotte.vehicle_assignments', vehicle_id=vehicle.id) }}" class="btn-hl btn-hl-outline">
              <i class="fas fa-times me-2"></i>Annuler
            </a>
            <button type="submit" class="btn-hl btn-hl-primary">
              <i class="fas fa-check me-2"></i>Créer l'Assignation
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}

